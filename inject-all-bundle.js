(()=>{"use strict";var t={d:(e,n)=>{for(var i in n)t.o(n,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:n[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{af:()=>i,am:()=>r,ar:()=>o,az:()=>a,bar:()=>s,be:()=>u,bg:()=>l,bn:()=>c,bs:()=>d,ca:()=>h,ca$valencia:()=>g,ckb:()=>p,cs:()=>m,cy:()=>f,da:()=>v,de:()=>L,de_CH:()=>x,el:()=>E,en_CA:()=>b,en_GB:()=>w,en_US:()=>T,eo:()=>y,es:()=>R,es_:()=>C,es_419:()=>k,es_AR:()=>S,es_MX:()=>P,es_PE:()=>A,et:()=>_,eu:()=>M,fa:()=>N,fi:()=>B,fil:()=>D,fr:()=>O,fy:()=>H,ga:()=>z,gd:()=>I,gl:()=>K,gu:()=>j,he:()=>G,hi:()=>U,hr:()=>q,hu:()=>Y,hy:()=>F,ia:()=>X,id:()=>$,io:()=>V,is:()=>J,it:()=>W,ja:()=>Q,ja_KS:()=>Z,jbo:()=>tt,ka:()=>et,kab:()=>nt,kmr:()=>it,kn:()=>rt,ko:()=>ot,ln:()=>at,lt:()=>st,lv:()=>ut,man:()=>lt,mk:()=>ct,ml:()=>dt,mn:()=>gt,mr:()=>ht,ms:()=>pt,nb:()=>mt,nl:()=>ft,nn:()=>vt,pa:()=>xt,pcm:()=>Lt,pl:()=>Et,pt_BR:()=>bt,pt_PT:()=>wt,ro:()=>Tt,ru:()=>yt,sc:()=>Ct,si:()=>kt,sk:()=>St,sl:()=>Pt,sq:()=>At,sr:()=>_t,sr_Latn:()=>Rt,sv:()=>Mt,sw:()=>Nt,ta:()=>Bt,te:()=>Dt,th:()=>Ot,tr:()=>Ht,uk:()=>zt,vi:()=>It,zh_CN:()=>Kt,zh_HK:()=>jt,zh_TW:()=>Gt});const n=JSON.parse('{"M":{"pb":[["af","Afrikaans","Afrikaans"],["az","Azerbaijani","Azərbaycanca"],["be","Belarusian","Беларуская"],["bg","Bulgarian","български"],["ca","Catalan","Català"],["ca-valencia","Valencian","Valencià"],["cs","Czech","Čeština"],["da","Danish","Dansk"],["de","German","Deutsch"],["de-CH","German (Switzerland)","Deutsch (Schweiz)"],["el","Greek","Ελληνικά"],["en-US","English (US)","English (US)"],["en-GB","English (UK)","English (UK)"],["es","Spanish","Español"],["et","Estonian","Eesti keel"],["fa","Persian","فارسی"],["fi","Finnish","Suomi"],["fr","French","Français"],["fy","Frisian","Frysk"],["gd","Scots Gaelic","Gàidhlig"],["gl","Galician","Galego"],["hu","Hungarian","Magyar"],["hr","Croatian","Hrvatski"],["hy","Armenian","Հայերեն"],["id","Indonesian","Bahasa Indonesia"],["is","Icelandic","Íslenska"],["it","Italian","Italiano"],["ja-KS","Japanese (Kansai)","関西弁"],["ja","Japanese","日本語"],["ka","Georgian","ქართული"],["kab","Kabyle","Taqbaylit"],["ko","Korean","한국어"],["kmr","Kurdish (Kurmanji)","Kurdî"],["lt","Lithuanian","Lietuvių"],["nb","Norwegian (Bokmål)","Norsk (bokmål)"],["nn","Norwegian (Nynorsk)","Norsk (nynorsk)"],["nl","Dutch","Nederlands"],["pa","Punjabi","ਪੰਜਾਬੀ"],["pl","Polish","Polski"],["pt-BR","Portuguese (Brazil)","Português (Brasil)"],["pt-PT","Portuguese (Portugal)","Português (Europeu)"],["ro","Romanian","Română"],["ru","Russian","Русский"],["si","Sinhala","සිංහල"],["sk","Slovak","Slovenčina"],["sl","Slovenian","Slovenščina"],["sq","Albanian","Shqip"],["sr","Serbian","Српски"],["sr-Latn","Serbian (Latin)","Srpski"],["sv","Swedish","Svenska"],["tr","Turkish","Türkçe"],["uk","Ukrainian","Українська"],["vi","Vietnamese","Tiếng Việt"],["zh-CN","Chinese (Simplified)","简体中文"],["zh-TW","Chinese (Traditional)","正體中文"]]}}');function i(t){return 1!==t}function r(t){return t>1}function o(t){return 0===t?0:1===t?1:2===t?2:t%100>=3&&t%100<=10?3:t%100>=11?4:5}function a(t){return 1!==t}function s(t){return 1!==t}function u(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function l(t){return 1!==t}function c(t){return t>1}function d(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function g(t){return 1!==t}function h(t){return 1!==t}function p(t){return 1!==t}function m(t){return 1===t?0:t>=2&&t<=4?1:2}function f(t){return 2===t?1:0}function v(t){return 1!==t}function x(t){return 1!==t}function L(t){return 1!==t}function E(t){return 1!==t}function b(t){return 1!==t}function w(t){return 1!==t}function T(t){return 1!==t}function y(t){return 1!==t}function C(t){return 1!==t}function k(t){return 1!==t}function S(t){return 1!==t}function P(t){return 1!==t}function A(t){return 1!==t}function R(t){return 1!==t}function _(t){return 1!==t}function M(t){return 1!==t}function N(t){return 0}function B(t){return 1!==t}function D(t){return t>1}function O(t){return t>1}function H(t){return 1!==t}function z(t){return 1===t?0:2===t?1:t>2&&t<7?2:t>6&&t<11?3:4}function I(t){return 1===t||11===t?0:2===t||12===t?1:t>2&&t<20?2:3}function K(t){return 1!==t}function j(t){return 1!==t}function G(t){return 1!==t}function U(t){return 1!==t}function q(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function Y(t){return 1!==t}function F(t){return 1!==t}function X(t){return 1!==t}function $(t){return 0}function V(t){return 1!==t}function J(t){return t%10!=1||t%100==11}function W(t){return 1!==t}function Z(t){return 0}function Q(t){return 0}function tt(t){return 0}function et(t){return 0}function nt(t){return t>1}function it(t){return 1!==t}function rt(t){return 1!==t}function ot(t){return 0}function at(t){return t>1}function st(t){return t%10==1&&(t%100<11||t%100>19)?0:t%10>=2&&t%10<=9&&(t%100<11||t%100>19)?1:2}function ut(t){return t%10==1&&t%100!=11?0:0!==t?1:2}function lt(t){return 1!==t}function ct(t){return t%10==1&&t%100!=11?0:1}function dt(t){return 1!==t}function gt(t){return 1!==t}function ht(t){return 1!==t}function pt(t){return 0}function mt(t){return 1!==t}function ft(t){return 1!==t}function vt(t){return 1!==t}function xt(t){return t>1}function Lt(t){return 1!==t}function Et(t){return 1===t?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function bt(t){return 1!==t}function wt(t){return 1!==t}function Tt(t){return 1===t?0:0===t||t%100>0&&t%100<20?1:2}function yt(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function Ct(t){return 1!==t}function kt(t){return t>1}function St(t){return 1===t?0:t>=2&&t<=4?1:2}function Pt(t){return t%100==1?0:t%100==2?1:t%100==3||t%100==4?2:3}function At(t){return 1!==t}function Rt(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function _t(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function Mt(t){return 1!==t}function Nt(t){return 1!==t}function Bt(t){return 1!==t}function Dt(t){return 1!==t}function Ot(t){return 0}function Ht(t){return t>1}function zt(t){return t%10==1&&t%100!=11?0:t%10>=2&&t%10<=4&&(t%100<10||t%100>=20)?1:2}function It(t){return 0}function Kt(t){return 0}function jt(t){return 0}function Gt(t){return 0}const Ut=self.chrome,qt=new RegExp("([^a-z0-9])","g");function Yt(t,e){return"_"+e.charCodeAt(0)+"_"}function Ft(t){return 1!==t}const Xt=Ut.i18n.getUILanguage().replace("-","_").replace("@","$"),$t=Xt in e?e[Xt]:Ft;function Vt(t,e){return Array.isArray(e)?t.replace(/\$\d/g,(t=>{const n=parseInt(t.substr(1))-1;if(e.length>n)return e[n].toString();throw new Error("Faulty string variables. Requested string "+(n+1)+" of "+e.length)})):t}const Jt=(t,e,n)=>"string"==typeof e?Array.isArray(n)&&"number"==typeof n[0]?function(t,e,n){const i=n[0];let r=$t(i);!1===r?r=0:!0===r&&(r=1);const o=Ut.i18n.getMessage(t.replace(qt,Yt)+r,n);return""===o?Vt(1===i?t:e,n):o}(t,e,n):function(t,e){const n=Ut.i18n.getMessage(t.replace(qt,Yt)+"_4_"+e.replace(qt,Yt)+"0");return""===n?e:n}(t,e):function(t,e){const n=Ut.i18n.getMessage(t.replace(qt,Yt)+"0",e);return""===n?Vt(t,e):n}(t,e),Wt=(n.M.pb.map((([t,e,n])=>({key:t,value:Jt(e),local:n}))),Jt("Amharic"),Jt("Arabic"),Jt("Bengali"),Jt("Bosnian"),Jt("Cebuano"),Jt("Corsican"),Jt("Welsh"),Jt("Esperanto"),Jt("Basque"),Jt("Irish Gaelic"),Jt("Gujarati"),Jt("Hausa"),Jt("Hawaiian"),Jt("Hebrew"),Jt("Hindi"),Jt("Hmong, Mong"),Jt("Haitian Creole"),Jt("Igbo"),Jt("Javanese"),Jt("Georgian"),Jt("Kazakh"),Jt("Khmer"),Jt("Kannada"),Jt("Kyrgyz"),Jt("Latin"),Jt("Luxembourgish"),Jt("Lao"),Jt("Latvian"),Jt("Malagasy"),Jt("Maori"),Jt("Macedonian"),Jt("Malayalam"),Jt("Mongolian"),Jt("Marathi"),Jt("Malay"),Jt("Maltese"),Jt("Burmese"),Jt("Nepali"),Jt("Chichewa"),Jt("Oriya"),Jt("Pashto"),Jt("Kinyarwanda"),Jt("Sindhi"),Jt("Sinhala"),Jt("Samoan"),Jt("Shona"),Jt("Somali"),Jt("Southern Sotho"),Jt("Sundanese"),Jt("Swahili"),Jt("Tamil"),Jt("Telugu"),Jt("Tajik"),Jt("Thai"),Jt("Turkmen"),Jt("Tagalog"),Jt("Tatar"),Jt("Uyghur"),Jt("Urdu"),Jt("Uzbek"),Jt("Xhosa"),Jt("Yiddish"),Jt("Yoruba"),Jt("Zulu"),Object.entries({en:"en-US",es:"es-ES",ku:"kmr",no:"nb",pt:"pt-PT","sr-Cyrl":"sr","zh-Hans":"zh-CN","zh-Hant":"zh-TW"}).reduce(((t,[e,n])=>(t[n]=e,t)),{"de-CH":"de","en-GB":"en","ja-KS":"ja","sr-Latn":"sr",nn:"no","pt-BR":"pt",iw:"he",me:"hr"}));class Zt{constructor(t){this.containerElm=document.createElement("div"),this.containerElm.classList.add("vivaldi-translate-button-container"),this.button=document.createElement("button"),this.button.innerHTML='<svg width="16" height="16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path fill-rule="evenodd" clip-rule="evenodd" d="M13.848 3.349v.99H12.63c-.457 1.264-1.074 2.297-1.852 3.15.871.675 1.937 1.18 3.222 1.47-.245.247-.567.725-.719 1.015-1.361-.35-2.46-.922-3.349-1.682C9.5 9 9 9.5 8 10l-.638-.969C8.053 8.708 9 8 9.162 7.533c-.76-.88-1.344-1.947-1.8-3.194h-1.21v-.99h3.315V2h1.024v1.349h3.357zM9.992 6.773c.608-.666 1.09-1.469 1.454-2.434H8.478c.363.922.862 1.742 1.514 2.434z" />\n  <path d="M5.846 11.558H3.15L2.636 13H1l2.78-7h1.425L8 13H6.364l-.518-1.442zm-2.282-1.169h1.867l-.939-2.62-.928 2.62z" />\n</svg>',this.button.classList.add("vivaldi-translate-button"),this.containerElm.appendChild(this.button),this.button.addEventListener("click",t)}setPosition(t,e){this.containerElm.style.cssText=`left: ${t}px; top: ${e}px;`}isOurNode(t){const e=[this.containerElm,this.button];return Boolean(t&&(e.includes(t)||this.button.contains(t)))}}class Qt{constructor(t,e,n,i,r){if(this.textElm)return;this.translateCallback=i,this.activeSrcLanguageCode=e,this.activeDestLanguageCode=n,this.textContainerElm=document.createElement("div"),this.textContainerElm.classList.add("vivaldi-translate-text-container"),this.closeButton=document.createElement("button"),this.closeButton.classList.add("vivaldi-translate-text-close"),this.closeButton.innerHTML='<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <path d="M4.29289 4.29289C4.68342 3.90237 5.31658 3.90237 5.70711 4.29289L8 6.58579L10.2929 4.29289C10.6834 3.90237 11.3166 3.90237 11.7071 4.29289C12.0976 4.68342 12.0976 5.31658 11.7071 5.70711L9.41421 8L11.7071 10.2929C12.0976 10.6834 12.0976 11.3166 11.7071 11.7071C11.3166 12.0976 10.6834 12.0976 10.2929 11.7071L8 9.41421L5.70711 11.7071C5.31658 12.0976 4.68342 12.0976 4.29289 11.7071C3.90237 11.3166 3.90237 10.6834 4.29289 10.2929L6.58579 8L4.29289 5.70711C3.90237 5.31658 3.90237 4.68342 4.29289 4.29289Z" />\n</svg>',this.textContainerElm.appendChild(this.closeButton),this.closeButton.addEventListener("click",r);let o=document.createElement("div");o.classList.add("vivaldi-translate-language");const a=this.createLanguageDropdown(t,e,!0);a.addEventListener("change",this.#t),o.appendChild(a),this.pageLanguageElm=document.createElement("div"),this.pageLanguageElm.classList.add("vivaldi-translate-src-language"),o.appendChild(this.pageLanguageElm),this.textContainerElm.appendChild(o),this.originalTextElm=document.createElement("div"),this.originalTextElm.classList.add("vivaldi-translate-text"),this.textContainerElm.appendChild(this.originalTextElm);const s=document.createElement("div");s.classList.add("vivaldi-translate-text-result-container"),this.textContainerElm.appendChild(s),o=document.createElement("div"),o.classList.add("vivaldi-translate-language"),this.destLangDropDown=this.createLanguageDropdown(t,n,!1),this.destLangDropDown.addEventListener("change",this.#e),o.appendChild(this.destLangDropDown),this.destLanguageElm=document.createElement("div"),this.destLanguageElm.classList.add("vivaldi-translate-dest-language"),o.appendChild(this.destLanguageElm),s.appendChild(o),this.textElm=document.createElement("div"),this.textElm.classList.add("vivaldi-translate-text-result"),s.appendChild(this.textElm),this.requestTimingElm=document.createElement("div"),this.requestTimingElm.classList.add("vivaldi-translate-timing"),s.appendChild(this.requestTimingElm),this.footerElm=document.createElement("div"),this.footerElm.classList.add("vivaldi-translate-footer"),this.footerElm.innerText=Jt("Powered by Lingvanex, hosted by Vivaldi."),this.textContainerElm.appendChild(this.footerElm)}getTranslationCode(t){return Wt[t]||t}createLanguageDropdown(t,e,n){const i=document.createElement("select");if(i.classList.add("vivaldi-translate-select-languages"),n){const t=document.createElement("option");t.setAttribute("value",e),t.innerText=Jt("Automatic Detection"),i.appendChild(t)}for(let o=0;o<t.length;o++){const a=this.getTranslationCode(t[o].key),s=document.createElement("option");s.setAttribute("value",a),s.innerText=(r=t[o]).local!==r.value?r.value+" ("+r.local+")":r.value,a!==e||n||s.setAttribute("selected","selected"),i.appendChild(s)}var r;return i}setPosition(t,e,n){this.textContainerElm.style.cssText=`left: ${t}px; top: ${e}px; width: ${n}px;`}setText(t,e){this.originalTextElm.innerText=t.sourceText[0],this.textElm.innerText=t.translatedText[0],e&&(this.requestTimingElm.innerText=Jt("$1 ms",[(e.endTime-e.startTime).toFixed(2)]))}setLanguageNames(t,e){this.pageLanguageElm.innerText=t,this.destLanguageElm.innerText=e}setSelectedDestLang(t){this.destLangDropDown.value=t}isOurNode(t){const e=[this.textElm,this.textContainerElm,this.requestTimingElm,this.closeButton,this.footerElm,this.pageLanguageElm,this.destLanguageElm];return Boolean(t&&e.includes(t))}#t=t=>{this.originalTextElm.innerText&&(this.activeSrcLanguageCode=t.target.value,this.translateCallback?.(this.activeSrcLanguageCode,this.activeDestLanguageCode,this.originalTextElm.innerText))};#e=t=>{this.originalTextElm.innerText&&(this.activeDestLanguageCode=t.target.value,this.translateCallback?.(this.activeSrcLanguageCode,this.activeDestLanguageCode,this.originalTextElm.innerText))}}const te=0,ee=3,ne=4,ie=6,re=7;function oe(t,e,n,i,r){let o="https://mimir2.vivaldi.com/api/translate";function a(t){if(t instanceof Response)return t.json();throw new Error("JSON Conversion error")}if(i&&(o=i),0===n.length)return;const s=performance.now();fetch(o,{method:"POST",headers:{Accept:"application/json","Content-type":"application/json"},body:ae(t,e,n)}).then((function(t){return t.status>=200&&t.status<300?Promise.resolve(t):Promise.reject(t)})).then(a).then((t=>{const e={error:!1,errorCode:te,sourceLang:t.detectedSourceLanguage,startTime:s,endTime:performance.now()};r(e,t)})).catch((t=>{const e={error:!0,errorCode:ie,sourceLang:"",startTime:s,endTime:performance.now()};a(t).then((t=>{console.error("Translate failed, error: "+t.code),e.errorCode=function(t){switch(t){case"LANGUAGE_NOT_RECOGNIZED":return ee;case"INVALID_LANG_CODE":return ne;case"TIMEOUT_ERROR":return re;default:return ie}}(t.code),r(e)})).catch((()=>{console.error("Translate request failed: ",t.statusText),r(e)}))}))}function ae(t,e,n){const i={target:e||"en",q:n};return t&&(i.source=t),JSON.stringify(i)}const se=new Map;function ue(t,e){return Ut.runtime.sendMessage(t,e)}class le{mouseX=0;mouseY=0;constructor(){this.networkInProgress=!1,this.buttonEnabled=!0,this.setupListeners()}createOrReplaceShadowRoot=()=>{if(document instanceof HTMLDocument||"application/xhtml+xml"===document.contentType){this.shadowHost&&(this.shadowHost.remove(),delete this.shadowHost);const t=document.createElement("span");document.documentElement?.appendChild(t),this.shadowHost=t;const e=this.shadowHost.attachShadow({mode:"closed"});return e.innerHTML="<style>\n:host {\n  position: absolute;\n  top: 0px;\n  left: 0px;\n  width: 0;\n}\n.vivaldi-translate-text-container {\n  display: block;\n  position: relative;\n  font-family: 'Roboto',arial,sans-serif;\n  font-size: 14px;\n  min-height: 150px;\n  min-width: 250px;\n  max-width: 1000px;\n  background-color: var(--colorBgLighter);\n  color: var(--colorFg);\n  box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.2);\n  border-width: 1px;\n  border-style: solid;\n  border-image: initial;\n  border-color: rgb(187, 187, 187) rgb(187, 187, 187) rgb(168, 168, 168);\n  border-radius: 6px;\n  margin: 0;\n  padding: 0;\n  z-index: 2147483647;\n}\n.vivaldi-translate-text-close {\n  position: relative;\n  cursor: pointer;\n  background-color: var(--colorBgLighter);\n  border: 0;\n  left: calc(100% - 20px);\n  top: 5px;\n  margin: 0;\n  padding: 0;\n  width: 16px;\n  height: 16px;\n}\n.vivaldi-translate-text-close > svg {\n  fill: var(--colorFg);\n}\n.vivaldi-translate-text-close:hover {\n  background-color: var(--colorBg);\n}\n.vivaldi-translate-text,\n.vivaldi-translate-text-result {\n  position: relative;\n  cursor: text;\n  -webkit-appearance: none;\n  top: 0px;\n  left: 0px;\n  overflow-y: auto;\n  margin-right: 10px;\n  margin-bottom: 16px;\n  padding: 6px;\n  border-width: 0px;\n  height: 100%;\n  transition: opacity 0.3s;\n  outline: unset;\n  color: var(--colorFgFadedMore);\n}\n.vivaldi-translate-text-result {\n  color: var(--colorFg);\n}\n.vivaldi-translate-text-result-container {\n  margin: 0;\n  padding: 0;\n  padding-top: 12px;\n  background-color: var(--colorBg);\n  border-width: 1px 0 1px 0;\n  border-style: solid;\n  border-image: initial;\n  border-color: var(--colorBorder);\n}\n.vivaldi-translate-select-languages {\n  width: 200px;\n  font-family: 'Roboto',arial,sans-serif;\n  font-size: 12px;\n  margin-left: 6px;\n  background-color: var(--colorBgLighter);\n  color: var(--colorFg);\n}\n.vivaldi-translate-src-language,\n.vivaldi-translate-dest-language {\n  padding-left: 6px;\n  font-weight: 600;\n  font-size: 10px;\n}\n.vivaldi-translate-language {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n}\n.vivaldi-translate-timing {\n  font-size: 8px;\n  text-align: right;\n  margin-right: 6px;\n  margin-bottom: 6px;\n  padding: 0 6px;\n}\n.vivaldi-translate-footer {\n  font-size: 10px;\n  padding: 4px;\n  background-color: var(--colorBgDark);\n  margin: 0;\n  border-bottom-right-radius: 6px;\n  border-bottom-left-radius: 6px;\n}\n.vivaldi-translate-button-container {\n  display: block;\n  position: relative;\n  cursor: pointer;\n  overflow: hidden;\n  box-shadow: 0px 0px 5px 2px rgba(0, 0, 0, 0.2);\n  border-radius: 2px;\n  z-index: 2147483647;\n  width: 32px;\n  height: 32px;\n}\n.vivaldi-translate-button {\n  position: relative;\n  -webkit-appearance: none;\n  background-color: var(--colorBg);\n  top: 0px;\n  left: 0px;\n  width: 32px;\n  height: 32px;\n  margin-left: 0px;\n  margin-top: 0px;\n  padding: 6px;\n  border-width: 1px;\n  transition: opacity 0.3s;\n  cursor: pointer;\n  outline: solid rgb(200, 200, 200);\n}\n.vivaldi-translate-button > svg {\n  fill: var(--colorFg);\n}\n.vivaldi-translate-button:hover {\n  background-color: var(--colorBgLighter);\n}\n</style>",Object.keys(this.styles).forEach((t=>{this.shadowHost.style.setProperty(t,this.styles[t])})),e}};createButton=()=>{const t=new Zt(this.onClicked);return this.createOrReplaceShadowRoot()?.appendChild(t.containerElm),t};hideButton=()=>{const{button:t}=this;t&&(t.containerElm.remove(),t.button.removeEventListener("click",this.onClicked),delete this.button)};createTranslationPopup=()=>{const t=new Qt(this.allLanguages,this.textLanguage,this.destLanguage,this.translateText,this.hideTranslationPopup),e=document.getSelection();if(e&&"Range"===e.type&&!this.isOurNode(e.anchorNode)){let i=this.mouseX,r=this.mouseY,o=300;var n=e.getRangeAt(0);if(n){const t=n.getBoundingClientRect();i=t.left+window.scrollX,r=t.top+t.height+window.scrollY;window.innerHeight<r+300+window.scrollY&&t.top-300-window.scrollY>=0&&(r=t.top-300-window.scrollY),o=Math.max(o,t.width)}const a=i,s=r;t.setPosition(a,s,o)}document.addEventListener("click",this.onClickOutside),document.addEventListener("keydown",this.onKeyPressed,!0);return this.createOrReplaceShadowRoot()?.appendChild(t.textContainerElm),t};updateTranslationPopup=(t,e,n)=>{t.setText(e,n);const i=e=>{const n=this.allLanguages.find((n=>{const i=t.getTranslationCode(n.key);return n.key===e||i===e}));return n?n.value:Jt("Unknown ($1)",[e])},r=i(e.detectedSourceLanguage),o=i(this.destLanguage);t.setLanguageNames(r,o),t.setSelectedDestLang(this.destLanguage)};hideTranslationPopup=()=>{if(!this.popup)return;const{popup:t}=this;t.textContainerElm.remove(),document.removeEventListener("click",this.onClickOutside),document.removeEventListener("keydown",this.onKeyPressed,!0),t.closeButton.removeEventListener("click",this.hideTranslationPopup),delete t.translateCallback,delete this.popup};extractText=()=>{const t=document.getSelection();if(t&&"Range"===t.type){const e=t.toString();if(e.length>4&&e.length<2e3)return e}return null};isOurNode=t=>{const e=[this.shadowHost];return Boolean(t&&(e.includes(t)||this.popup&&this.popup.isOurNode(t)||this.button&&this.button.isOurNode(t)))};onClickOutside=t=>{this.isOurNode(t.target)||this.hideTranslationPopup()};onKeyPressed=t=>{"Escape"===t.key&&this.hideTranslationPopup()};translateText=(t,e,n)=>{this.networkInProgress=!0,this.destLanguage=e,oe(t,e,[n],this.overrideServer,((t,n)=>{if(this.networkInProgress=!1,!t.error&&n){ue({type:"TRANSLATE_RESULT",item:{id:"",srcItem:{code:n.detectedSourceLanguage,text:n.sourceText[0]},translatedItem:{code:e,text:n.translatedText[0]}},destLang:e}),this.popup||(this.popup=this.createTranslationPopup()),this.updateTranslationPopup(this.popup,n,t)}}))};onClicked=t=>{const e=this.extractText();e&&!this.networkInProgress&&(this.hideButton(),ue({type:"TRANSLATE_SELECTION_BUTTON_CLICKED",text:e}),t.preventDefault(),t.stopPropagation())};requestLanguageDetection=t=>{t.length>20&&ue({type:"TRANSLATE_DETERMINE_LANGUAGE",text:t})};setupListeners=()=>{document.addEventListener("mouseup",(t=>{this.mouseX=t.pageX,this.mouseY=t.pageY}),!1),document.addEventListener("selectionchange",(()=>{this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((()=>{const t=document.getSelection();if(!t||"Range"!==t.type||t.isCollapsed||this.isOurNode(t.anchorNode))this.hideButton(),this.textLanguage="";else{const e=t.toString();if(e&&e.length>4&&e.length<2e3){const e=this.mouseX;let n=this.mouseY+20;if(window.innerHeight<n+40-window.scrollY){const e=t.getRangeAt(0).getBoundingClientRect();e.top-40+window.scrollY>=0&&(n=e.top-40+window.scrollY)}this.requestLanguageDetection(t.toString()),this.buttonEnabled&&(this.button||(this.button=this.createButton()),this.button.setPosition(e-20,n))}}}),500)})),function(t){const e=(e,n,i)=>{Ut.runtime.id===n.id&&t(e,n,i)};se.set(t,e),Ut.runtime.onMessage.addListener(e)}(this.onMessageReceived),ue({type:"TRANSLATE_SELECTION_READY"})};onMessageReceived=(t,e,n)=>{switch(t.type){case"TRANSLATE_INIT_DATA":return this.destLanguage=t.destLanguage,this.allLanguages=t.allLanguages,this.buttonEnabled=t.buttonEnabled,this.overrideServer=t.overrideServer,this.styles=t.styles,n(),!0;case"TRANSLATE_TEXT_LANGUAGE":return t.textLanguage?this.textLanguage=t.textLanguage:this.textLanguage="",n(),!0;case"TRANSLATE_SELECTION":{this.destLanguage=t.destLanguage,this.allLanguages=t.allLanguages;const e=t.text;return this.translateText(t.textLanguage,this.destLanguage,e),n(),!0}}return!1}}window.__vivaldiContentScriptsInitialized||(window.__vivaldiContentScriptsInitialized=!0,/^(https?|file):/.test(window.location.href)&&(window.__vivaldiUseBossSelect&&function(){function t(t,e){return document.caretRangeFromPoint(t,e)}function e(t){return(t instanceof HTMLAnchorElement||t instanceof HTMLLinkElement)&&t.href?t:!(t instanceof Node)||!t.parentNode||"src"in t||t instanceof HTMLElement&&"http://www.w3.org/2000/svg"===t.namespaceURI?void 0:e(t.parentNode)}const n=function(t){return t.preventDefault(),t.stopPropagation(),!1},i=function(t,e=!0){const n=[].concat(t);if(e)for(let t=0,e=n.length;t<e;t+=1)document.addEventListener(n[t],f[n[t]],!0);else for(let t=0,e=n.length;t<e;t+=1)document.removeEventListener(n[t],f[n[t]],!0)},r=function(t){i(t,!1)};let o,a,s,u,l,c,d,g,h;const p=document.getSelection(),m=function(){if(c){const t=c;t.style.removeProperty("cursor"),t.style.removeProperty("user-select"),0===t.style.length&&t.removeAttribute("style")}},f={mousemove:function(e){if(!p)return;const n=p;if(h){const{x:t,y:e}=h;if(h.c++<12){const i=h.n.getBoundingClientRect();if(Math.round(i.left)!==t||Math.round(i.top)!==e)return r(["mousemove","mouseup","dragend","dragstart","click"]),void n.removeAllRanges()}else h=null}const g=e.clientX,m=e.clientY;if(u){n.removeAllRanges();const e=t(g+(g>o.x?-2:2),m);e&&(n.addRange(e),u=!1)}if(a){if(c&&!1!==d){const{style:t}=c;t.setProperty("cursor","pointer","important"),t.setProperty("user-select","none","important")}const t=Math.abs(o.x-g),e=Math.abs(o.y-m);if(s=!1===d||t>=1&&(0===e||e/t<.6),Math.sqrt(Math.pow(t,2)+Math.pow(e,2))>6){if(c){const{style:t}=c;if(!1!==d){const t="Vivaldi: Link transitioned from draggable to text-selection mode.\nSee: https://help.vivaldi.com/?p=104354:";queueMicrotask(console.info.bind(console,t))}t.setProperty("cursor","text","important"),t.setProperty("user-select","auto","important")}a=!1,l=!0,i("click")}}if(s&&!a){const e=t(g,m);e&&n.extend(e.startContainer,e.startOffset)}},dragstart:function(t){if(r("dragstart"),s)return n(t)},mouseup:function(t){p&&(m(),r(["mousemove","mouseup","dragstart","dragend"]),!s&&l&&(l=!1),setTimeout((()=>{r("click")}),111))},dragend:function(t){m(),r(["dragend","mousemove","mouseup"])},click:function(t){if(r("click"),l)return n(t)}};document.addEventListener("mousedown",(function(n){if(!p||0!==n.button)return;a=u=!0,s=l=!1,c=void 0,d=null;const r=p;if(c=e(n.target),!c)return;const f=c;if(d=null===f.getAttribute("draggable")?null:!!f.draggable,!0===d)return;if(g=window.getComputedStyle(f),"none"===g.pointerEvents)return;if(n.altKey&&!n.ctrlKey&&!n.shiftKey&&!n.metaKey)return void m();const v=n.clientX,x=n.clientY;if("Range"===r.type){const e=t(v,x);if(e&&r.getRangeAt(0).isPointInRange(e.startContainer,e.startOffset))return}const L=f.getBoundingClientRect();h={n:f,x:Math.round(L.left),y:Math.round(L.top),c:0},o={x:v,y:x},f.style.setProperty("cursor","pointer","important"),f.style.setProperty("user-select","none","important"),i(["mousemove","mouseup","dragend","dragstart"])}),!0)}(),window.__vivaldiUseTranslateSelection&&new le))})();